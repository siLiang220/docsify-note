### 维度建模事实表
1. 事物型事实表，保存业务过程的原子操作事件，即最细粒度的操作事件
2. 周期快照事实表，
3. 累计快照事实表
###### 事实表设计流程
选择业务过程→声明粒度→确认维度→确认事实
- 例如电商交易中的下单，取消订单，付款，退单等，都是业务过程。通常情况下，**一个业务过程对应一张事务型事实表**
- 粒度是指事实表中一行数据所表达的业务细节程度。
- 事实是指每个业务过程的度量值（通常是可累加的数字类型的值，例如：次数、个数、件数、金额等）

### ODS层
1. ODS层的表结构设计依托于从业务系统同步过来的数据结构。
2. ODS层要保存全部历史数据，故其压缩格式应选择压缩比较高的，此处选择gzip。
3. DS层表名的命名规范为：ods_表名_单分区增量全量标识（inc/full）。
### DWD层 
1. DWD层的设计依据是维度建模理论，该层存储维度模型的事实表。
2. DWD层的数据存储格式为orc列式存储+snappy压缩。
3. DWD层表名的命名规范为dwd_数据域_表名_单分区增量全量标识（inc/full）


### DIM层
DIM层设计要点：
1. DIM层的设计依据是维度建模理论，该层存储维度模型的维度表。
2. DIM层的数据存储格式为orc列式存储+snappy压缩。
3. DIM层表名的命名规范为dim_表名_全量表或者拉链表标识（full/zip）
### DWD层
DWD层设计要点：
1. DWD层的设计依据是维度建模理论，该层存储维度模型的事实表。
2. DWD层的数据存储格式为orc列式存储+snappy压缩。
3. DWD层表名的命名规范为dwd_数据域_表名_单分区增量全量标识（inc/full）
4. 不成文规定，不取同一层的数据做查询载入
5. 数据判空，如果为空或NULL时设置默认值
### 数仓构建流程
1. 数据调研： 业务调研需求分析
2. 明确数据域 ： 按照特定标准对数据进行纵向划分
-  构建业务总线矩阵：按照维度建模理论，对业务数据进行分析，抽象出业务过程和维度
-  维度模型设计： 构建DWD 和DIM
-  明确统计指标 对报表需求进行分析，整理出指标体系，包括原子指标、派生指标、衍生指标
-  汇总模型设计 构建DWS层
3. 开发
##### 指标体系概念
1. 原子指标 
- 基于某一业务过程的度量值，原子指标的核心功能是对指标的聚合逻辑，原子指标包含的三要素 **业务过程、度量值、集合逻辑**
2. 派生指标
- 派生指标基于原子指标
- 派生指标= **原子指标+统计周期+业务限定+统计粒度**
。 统计周期指的是统计的时间范围，业务限定统计范围相当于where，统计粒度相当与sql中的GroupBy
3. 衍生指标
- 一个或多个派生指标的基础商，通过各种逻辑运算复合而成的，例如比例，比率等类型的指标
- 例如30天个品牌退货率 ，统计30天各品牌的下单次数与30天各品牌退单的次数
#### DWS层
 业务过程、统计周期与统计粒度相同的派生指标即可放在同一个汇总表
- 设计要点
1. DWS层的设计参考指标体系。
2. DWS层的数据存储格式为orc列式存储+snappy压缩。
3. DWS层表名的命名规范为dws_数据域_统计粒度_业务过程_统计周期（1d/nd/td）
注：1d表示最近1日，nd表示最近n日，td表示历史至今。
#### ADS层



